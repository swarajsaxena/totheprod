{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "ttp-command-palette",
  "type": "registry:block",
  "title": "Command Palette",
  "description": "Command palette with beautiful keyboard-first navigation inspired by Raycast",
  "dependencies": ["motion", "cmdk"],
  "files": [
    {
      "path": "components/ui/totheprod-ui/ttp-command-palette.tsx",
      "content": "/**\n * @file RaycastCommandMenu Component\n * @description A command menu component inspired by Raycast's design with keyboard shortcuts support.\n *\n * Features:\n * - Keyboard shortcut support via react-hotkeys-hook\n * - Context-based state management\n * - Composable components for flexible layouts\n * - Search functionality with sections\n * - Optional banner and footer\n *\n * @example\n * ```tsx\n * <CommandPaletteProvider shortcut=\"mod+k\">\n *   <RaycastCommandMenu>\n *     <CommandPaletteInput placeholder=\"Search...\" />\n *     <CommandPaletteContent>\n *       <CommandPaletteSection title=\"Navigation\">\n *         <CommandPaletteItem icon={<Icon />} title=\"Home\" onSelect={() => {}} />\n *       </CommandPaletteSection>\n *     </CommandPaletteContent>\n *   </RaycastCommandMenu>\n * </CommandPaletteProvider>\n * ```\n */\n\n\"use client\"\n\n// biome-ignore lint/performance/noNamespaceImport: React namespace needed for complex component patterns\nimport * as React from \"react\"\nimport { useHotkeys } from \"react-hotkeys-hook\"\nimport {\n  CommandDialog,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from \"@/components/ui/command\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { cn } from \"@/lib/utils\"\n\n/**\n * Types\n */\nexport type RaycastCommandItem = {\n  id: string\n  icon: React.ReactNode\n  title: string\n  description?: string\n  type?: string\n  onSelect?: () => void\n  actions?: RaycastAction[]\n}\n\nexport type RaycastAction = {\n  id: string\n  icon?: React.ReactNode\n  label: string\n  shortcut?: string[]\n  onAction?: () => void\n}\n\nexport type RaycastSection = {\n  id: string\n  title: string\n  items: RaycastCommandItem[]\n}\n\n/**\n * Utility function to parse shortcut string to display format\n */\nconst parseShortcutToDisplay = (shortcut: string): string[] => {\n  const isMac =\n    typeof window !== \"undefined\" &&\n    navigator.platform.toUpperCase().indexOf(\"MAC\") >= 0\n\n  return shortcut.split(\"+\").map((key) => {\n    const normalizedKey = key.toLowerCase().trim()\n\n    switch (normalizedKey) {\n      case \"mod\":\n      case \"meta\":\n      case \"cmd\":\n      case \"command\":\n        return isMac ? \"⌘\" : \"Ctrl\"\n      case \"ctrl\":\n      case \"control\":\n        return isMac ? \"⌃\" : \"Ctrl\"\n      case \"shift\":\n        return isMac ? \"⇧\" : \"Shift\"\n      case \"alt\":\n      case \"option\":\n        return isMac ? \"⌥\" : \"Alt\"\n      default:\n        return key.toUpperCase()\n    }\n  })\n}\n\n/**\n * Context\n */\ntype RaycastCommandMenuContextType = {\n  open: boolean\n  setOpen: (open: boolean) => void\n  search: string\n  setSearch: (search: string) => void\n  selectedItem: RaycastCommandItem | null\n  setSelectedItem: (item: RaycastCommandItem | null) => void\n  showActions: boolean\n  setShowActions: (show: boolean) => void\n  itemsRegistry: React.MutableRefObject<Map<string, RaycastCommandItem>>\n  actionsShortcut: string\n}\n\nconst RaycastCommandMenuContext = React.createContext<\n  RaycastCommandMenuContextType | undefined\n>(undefined)\n\n/**\n * Hook to access command menu context\n */\nexport const useRaycastCommandMenu = () => {\n  const context = React.useContext(RaycastCommandMenuContext)\n\n  if (!context) {\n    throw new Error(\n      \"useRaycastCommandMenu must be used within RaycastCommandMenu\"\n    )\n  }\n\n  return context\n}\n\n/**\n * Hook to access command menu open state\n * Useful for controlling the menu from external components\n */\nexport const useTtpCommandPaletteState = () => {\n  const context = React.useContext(RaycastCommandMenuContext)\n\n  if (!context) {\n    throw new Error(\n      \"useTtpCommandPaletteState must be used within TtpCommandPalette\"\n    )\n  }\n\n  return {\n    open: context.open,\n    setOpen: context.setOpen,\n  }\n}\n\n/**\n * Provider Component (can be used standalone)\n */\nexport const CommandPaletteProvider = ({\n  children,\n  shortcut = \"mod+k\",\n  actionsShortcut = \"mod+k\",\n  open: controlledOpen,\n  onOpenChange,\n}: {\n  children: React.ReactNode\n  shortcut?: string\n  actionsShortcut?: string\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) => {\n  const [internalOpen, setInternalOpen] = React.useState(false)\n  const [search, setSearch] = React.useState(\"\")\n  const [selectedItem, setSelectedItem] =\n    React.useState<RaycastCommandItem | null>(null)\n  const [showActions, setShowActions] = React.useState(false)\n  const itemsRegistry = React.useRef<Map<string, RaycastCommandItem>>(new Map())\n\n  // Use controlled state if provided, otherwise use internal state\n  const isControlled = controlledOpen !== undefined\n  const open = isControlled ? controlledOpen : internalOpen\n\n  const setOpen = React.useCallback(\n    (value: boolean | ((prev: boolean) => boolean)) => {\n      const newValue = typeof value === \"function\" ? value(open) : value\n\n      if (isControlled) {\n        onOpenChange?.(newValue)\n      } else {\n        setInternalOpen(newValue)\n      }\n    },\n    [isControlled, onOpenChange, open]\n  )\n\n  // Main menu toggle shortcut\n  useHotkeys(\n    shortcut,\n    (e) => {\n      e.preventDefault()\n      setOpen((prev) => !prev)\n    },\n    {\n      enableOnFormTags: true,\n      enableOnContentEditable: true,\n      enabled: true,\n      preventDefault: true,\n    },\n    [setOpen]\n  )\n\n  useHotkeys(\n    \"esc\",\n    (e) => {\n      e.preventDefault()\n      setOpen(false)\n    },\n    {\n      enableOnFormTags: true,\n      enableOnContentEditable: true,\n      enabled: open,\n      preventDefault: true,\n    },\n    [open]\n  )\n\n  // Actions popover toggle shortcut\n  useHotkeys(\n    actionsShortcut,\n    (e) => {\n      if (open && selectedItem?.actions && selectedItem.actions.length > 0) {\n        e.preventDefault()\n        setShowActions((prev) => !prev)\n      }\n    },\n    {\n      enableOnFormTags: true,\n      enableOnContentEditable: true,\n      enabled:\n        open && !!selectedItem?.actions && selectedItem.actions.length > 0,\n      preventDefault: true,\n    },\n    [open, selectedItem, setShowActions]\n  )\n\n  React.useEffect(() => {\n    if (!open) {\n      setShowActions(false)\n      setSelectedItem(null)\n      setSearch(\"\")\n      itemsRegistry.current.clear()\n    }\n  }, [open])\n\n  return (\n    <RaycastCommandMenuContext.Provider\n      value={{\n        open,\n        setOpen,\n        search,\n        setSearch,\n        selectedItem,\n        setSelectedItem,\n        showActions,\n        setShowActions,\n        itemsRegistry,\n        actionsShortcut,\n      }}\n    >\n      {children}\n    </RaycastCommandMenuContext.Provider>\n  )\n}\n\n/**\n * Dialog Component (can be used standalone with provider)\n */\nexport const CommandPaletteDialog = ({\n  children,\n  className,\n  showCloseButton = false,\n  showOverlay = false,\n  title = \"Command Menu\",\n  description = \"Search for apps, commands, and actions\",\n}: {\n  children: React.ReactNode\n  className?: string\n  showCloseButton?: boolean\n  showOverlay?: boolean\n  title?: string\n  description?: string\n}) => {\n  const { open, setOpen, itemsRegistry, setSelectedItem } =\n    useRaycastCommandMenu()\n  const [commandValue, setCommandValue] = React.useState<string>(\"\")\n\n  const handleValueChange = React.useCallback(\n    (value: string) => {\n      setCommandValue(value)\n      const item = itemsRegistry.current.get(value)\n      if (item) {\n        setSelectedItem(item)\n      }\n    },\n    [itemsRegistry, setSelectedItem]\n  )\n\n  // Reset command value when dialog closes\n  React.useEffect(() => {\n    if (!open) {\n      setCommandValue(\"\")\n    }\n  }, [open])\n\n  return (\n    <CommandDialog\n      className={cn(\n        \"w-full rounded-2xl bg-muted/75 backdrop-blur-md *:bg-transparent sm:max-w-3xl dark:bg-muted/50\",\n        className\n      )}\n      description={description}\n      onOpenChange={setOpen}\n      onValueChange={handleValueChange}\n      open={open}\n      showCloseButton={showCloseButton}\n      showOverlay={showOverlay}\n      title={title}\n      value={commandValue}\n    >\n      {children}\n    </CommandDialog>\n  )\n}\n\n/**\n * Main Component with built-in provider\n */\ntype RaycastCommandMenuProps = {\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n  children: React.ReactNode\n  className?: string\n  showCloseButton?: boolean\n  showOverlay?: boolean\n  shortcut?: string\n  actionsShortcut?: string\n  title?: string\n  description?: string\n}\n\nexport const RaycastCommandMenu = ({\n  open,\n  onOpenChange,\n  children,\n  className,\n  showCloseButton = false,\n  showOverlay = false,\n  shortcut = \"mod+k\",\n  actionsShortcut = \"mod+k\",\n  title = \"Command Menu\",\n  description = \"Search for apps, commands, and actions\",\n}: RaycastCommandMenuProps) => {\n  return (\n    <CommandPaletteProvider\n      actionsShortcut={actionsShortcut}\n      onOpenChange={onOpenChange}\n      open={open}\n      shortcut={shortcut}\n    >\n      <CommandPaletteDialog\n        className={className}\n        description={description}\n        showCloseButton={showCloseButton}\n        showOverlay={showOverlay}\n        title={title}\n      >\n        {children}\n      </CommandPaletteDialog>\n    </CommandPaletteProvider>\n  )\n}\n\n/**\n * Input Component\n */\ntype CommandPaletteInputProps = {\n  placeholder?: string\n  askAiLabel?: string | false\n  className?: string\n}\n\nexport const CommandPaletteInput = ({\n  placeholder = \"Search for apps and commands...\",\n  askAiLabel = \"Ask AI\",\n  className,\n}: CommandPaletteInputProps) => {\n  const { search, setSearch } = useRaycastCommandMenu()\n\n  return (\n    <div\n      className={cn(\"relative flex items-center border-b px-4 py-1\", className)}\n    >\n      <CommandInput\n        className=\"h-14 w-full flex-1 border-0 text-base\"\n        onValueChange={setSearch}\n        placeholder={placeholder}\n        value={search}\n      />\n      {askAiLabel && (\n        <div className=\"flex items-center gap-2\">\n          <button\n            className=\"text-muted-foreground text-sm hover:text-foreground\"\n            type=\"button\"\n          >\n            {askAiLabel}\n          </button>\n          <kbd className=\"pointer-events-none inline-flex h-6 select-none items-center gap-1 rounded-lg border bg-background px-1.5 font-fira font-medium text-[8px] text-muted-foreground opacity-100\">\n            <span className=\"text-xs\">Tab</span>\n          </kbd>\n        </div>\n      )}\n    </div>\n  )\n}\n\n/**\n * Banner Component\n */\ntype RaycastCommandMenuBannerProps = {\n  icon: React.ReactNode\n  title: string\n  version?: string\n  action: { label: string; onClick: () => void }\n  className?: string\n}\n\nexport const RaycastCommandMenuBanner = ({\n  icon,\n  title,\n  version,\n  action,\n  className,\n}: RaycastCommandMenuBannerProps) => {\n  return (\n    <div\n      className={cn(\n        \"flex items-center justify-between border-b px-4 py-3\",\n        className\n      )}\n    >\n      <div className=\"flex items-center gap-3\">\n        <div className=\"flex items-center gap-2\">\n          {icon}\n          <span className=\"font-medium\">{title}</span>\n        </div>\n        {version && (\n          <span className=\"text-muted-foreground text-sm\">{version}</span>\n        )}\n      </div>\n      <button\n        className=\"rounded-md px-3 py-1 text-muted-foreground text-sm transition-colors hover:text-foreground\"\n        onClick={action.onClick}\n        type=\"button\"\n      >\n        {action.label}\n      </button>\n    </div>\n  )\n}\n\n/**\n * Content Component\n */\ntype CommandPaletteContentProps = {\n  children: React.ReactNode\n  emptyText?: string\n  className?: string\n}\n\nexport const CommandPaletteContent = ({\n  children,\n  emptyText = \"No results found.\",\n  className,\n}: CommandPaletteContentProps) => {\n  return (\n    <CommandList\n      className={cn(\"max-h-[400px] overflow-y-auto py-2!\", className)}\n    >\n      <CommandEmpty className=\"p-8 text-center\">{emptyText}</CommandEmpty>\n      {children}\n    </CommandList>\n  )\n}\n\n/**\n * Section Component\n */\ntype CommandPaletteSectionProps = {\n  title: string\n  children: React.ReactNode\n  isLast?: boolean\n  className?: string\n}\n\nexport const CommandPaletteSection = ({\n  title,\n  children,\n  isLast: _isLast = false,\n  className,\n}: CommandPaletteSectionProps) => {\n  return (\n    <div className=\"group\">\n      <CommandGroup className={cn(\"has-[]: p-0!\", className)} heading={title}>\n        {children}\n      </CommandGroup>\n      <CommandSeparator className=\"mt-2\" />\n    </div>\n  )\n}\n\n/**\n * Item Component\n */\ntype CommandPaletteItemProps = {\n  id: string\n  icon: React.ReactNode\n  title: string\n  description?: string\n  type?: string\n  onSelect?: () => void\n  actions?: RaycastAction[]\n  className?: string\n  shortcut?: string\n}\n\nexport const CommandPaletteItem = ({\n  id,\n  icon,\n  title,\n  description,\n  type,\n  onSelect,\n  actions,\n  className,\n  shortcut,\n}: CommandPaletteItemProps) => {\n  const { setOpen, setSelectedItem, setShowActions, itemsRegistry } =\n    useRaycastCommandMenu()\n\n  const itemData = React.useMemo(\n    () => ({ id, icon, title, description, type, onSelect, actions }),\n    [id, icon, title, description, type, onSelect, actions]\n  )\n\n  useHotkeys(\n    // biome-ignore lint/style/noNonNullAssertion: Shortcut is validated before this point\n    shortcut!,\n    (e) => {\n      e.preventDefault()\n      onSelect?.()\n    },\n    {\n      enableOnFormTags: true,\n      enableOnContentEditable: true,\n      enabled: !!shortcut,\n      preventDefault: true,\n    },\n    [onSelect]\n  )\n\n  // Create searchable keywords from id, title, description, and type\n  const keywords = React.useMemo(() => {\n    const terms = [id, title]\n    if (description) {\n      terms.push(description)\n    }\n    if (type) {\n      terms.push(type)\n    }\n    return terms.join(\" \")\n  }, [id, title, description, type])\n\n  // Register/unregister item in the registry\n  React.useEffect(() => {\n    itemsRegistry.current.set(id, itemData)\n    return () => {\n      itemsRegistry.current.delete(id)\n    }\n  }, [id, itemData, itemsRegistry])\n\n  const handleSelect = React.useCallback(() => {\n    if (actions && actions.length > 0) {\n      setSelectedItem(itemData)\n      setShowActions(true)\n    } else {\n      onSelect?.()\n      setOpen(false)\n    }\n  }, [actions, itemData, onSelect, setOpen, setSelectedItem, setShowActions])\n\n  const handleMouseEnter = React.useCallback(() => {\n    setSelectedItem(itemData)\n  }, [itemData, setSelectedItem])\n\n  return (\n    <CommandItem\n      className={cn(\n        \"group mx-2 flex items-center justify-between gap-3 rounded-xl p-2! pl-2.5! text-foreground/70 data-[selected=true]:bg-muted-foreground/10! dark:data-[selected=true]:bg-background/40! [&_svg]:text-foreground/50! data-[selected=true]:[&_svg]:text-foreground!\",\n        className\n      )}\n      key={id}\n      keywords={[keywords]}\n      onMouseEnter={handleMouseEnter}\n      onSelect={handleSelect}\n      value={id}\n    >\n      <div className=\"flex min-w-0 flex-1 items-center gap-3\">\n        <div className=\"flex size-4! shrink-0 items-center justify-center rounded-md\">\n          {icon}\n        </div>\n        <div className=\"flex min-w-0 flex-1 items-center gap-1.5\">\n          <span className=\"truncate font-medium\">{title}</span>\n          {description && (\n            <span className=\"truncate text-muted-foreground text-xs\">\n              {description}\n            </span>\n          )}\n        </div>\n      </div>\n      {type && (\n        <span className=\"shrink-0 text-muted-foreground text-xs\">{type}</span>\n      )}\n      {shortcut && (\n        <DropdownMenuShortcut className=\"flex items-center gap-1\">\n          {shortcut.split(\"+\").map((key, keyIndex) => (\n            <kbd\n              className=\"pointer-events-none inline-flex select-none items-center justify-center rounded border bg-muted/50 px-1 py-0.5 font-fira font-medium text-[10px] text-muted-foreground dark:bg-muted\"\n              key={keyIndex}\n            >\n              {key}\n            </kbd>\n          ))}\n        </DropdownMenuShortcut>\n      )}\n    </CommandItem>\n  )\n}\n\n/**\n * Actions Dropdown Component (used internally by Footer)\n */\ntype RaycastCommandMenuActionsDropdownProps = {\n  className?: string\n  itemClassName?: string\n}\n\nexport const RaycastCommandMenuActionsDropdown = ({\n  className,\n  itemClassName,\n}: RaycastCommandMenuActionsDropdownProps = {}) => {\n  const { selectedItem } = useRaycastCommandMenu()\n\n  const actions = selectedItem?.actions || []\n\n  const handleActionExecute = React.useCallback((action: RaycastAction) => {\n    action.onAction?.()\n    // Keep dialog open as per requirements\n  }, [])\n\n  if (!selectedItem || actions.length === 0) {\n    return null\n  }\n\n  return (\n    <DropdownMenuContent\n      align=\"end\"\n      alignOffset={-8}\n      className={cn(\n        \"w-80 rounded-2xl bg-muted/10 backdrop-blur-sm dark:bg-background/30\",\n        className\n      )}\n      side=\"top\"\n      sideOffset={17}\n    >\n      {/* Header */}\n      <div className=\"px-2 py-1 text-muted-foreground text-xs\">Actions</div>\n\n      <DropdownMenuSeparator />\n\n      {/* Actions List */}\n      {actions.map((action) => (\n        <DropdownMenuItem\n          className={cn(\n            \"group mx-0 flex cursor-pointer items-center justify-between gap-3 rounded-xl p-2! pl-2.5! text-foreground/70 hover:bg-muted-foreground/10! focus:bg-muted-foreground/10! dark:focus:bg-background/40! dark:hover:bg-background/40! [&_svg]:text-foreground/50! hover:[&_svg]:text-foreground!\",\n            itemClassName\n          )}\n          key={action.id}\n          onClick={() => handleActionExecute(action)}\n        >\n          <div className=\"flex min-w-0 flex-1 items-center gap-3\">\n            {action.icon && (\n              <div className=\"flex size-4 shrink-0\">{action.icon}</div>\n            )}\n            <span className=\"truncate font-medium text-sm\">{action.label}</span>\n          </div>\n          {action.shortcut && action.shortcut.length > 0 && (\n            <DropdownMenuShortcut className=\"flex items-center gap-1\">\n              {action.shortcut.map((key, keyIndex) => (\n                <kbd\n                  className=\"pointer-events-none inline-flex select-none items-center justify-center rounded border bg-muted/50 px-1 py-0.5 font-fira font-medium text-[10px] text-muted-foreground dark:bg-muted\"\n                  key={keyIndex}\n                >\n                  {key}\n                </kbd>\n              ))}\n            </DropdownMenuShortcut>\n          )}\n        </DropdownMenuItem>\n      ))}\n    </DropdownMenuContent>\n  )\n}\n\n/**\n * Footer Component\n */\ntype CommandPaletteFooterProps = {\n  onBack?: () => void\n  secondaryActionLabel?: string\n  className?: string\n}\n\nexport const CommandPaletteFooter = ({\n  onBack,\n  secondaryActionLabel = \"Actions\",\n  className,\n}: CommandPaletteFooterProps) => {\n  const {\n    selectedItem,\n    showActions,\n    setShowActions,\n    setSelectedItem,\n    actionsShortcut,\n  } = useRaycastCommandMenu()\n\n  const hasActions = selectedItem?.actions && selectedItem.actions.length > 0\n\n  const displayShortcut = React.useMemo(\n    () => parseShortcutToDisplay(actionsShortcut),\n    [actionsShortcut]\n  )\n\n  const handleBack = React.useCallback(() => {\n    setShowActions(false)\n    setSelectedItem(null)\n    onBack?.()\n  }, [setShowActions, setSelectedItem, onBack])\n\n  return (\n    <div className={cn(\"border-t bg-muted/20 p-3\", className)}>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"flex items-center gap-2 text-muted-foreground text-sm\"\n          onClick={handleBack}\n          type=\"button\"\n        >\n          Back\n        </button>\n\n        {hasActions && (\n          <DropdownMenu onOpenChange={setShowActions} open={showActions}>\n            <DropdownMenuTrigger asChild>\n              <button\n                className={cn(\n                  \"flex items-center gap-2 text-sm transition-colors\",\n                  showActions\n                    ? \"text-foreground\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                )}\n                type=\"button\"\n              >\n                <span className=\"font-medium\">{secondaryActionLabel}</span>\n                <div className=\"flex items-center gap-1\">\n                  {displayShortcut.map((key, index) => (\n                    <kbd\n                      className=\"pointer-events-none inline-flex select-none items-center justify-center rounded border bg-muted/50 px-1 py-0.5 font-fira font-medium text-[10px] text-muted-foreground dark:bg-muted\"\n                      key={index}\n                    >\n                      {key}\n                    </kbd>\n                  ))}\n                </div>\n              </button>\n            </DropdownMenuTrigger>\n            <RaycastCommandMenuActionsDropdown />\n          </DropdownMenu>\n        )}\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    }
  ],
  "meta": {
    "category": "navigation-and-menus",
    "tags": ["command", "menu", "keyboard", "search", "palette"],
    "installCommand": "npx shadcn@latest add https://ui.totheprod.com/r/ttp-command-palette.json"
  }
}
